seed: 42

data:
  dataset: mnist
  root: data
  batch_size: 128
  num_workers: 4
  image_size: 28

diffusion:
  T: 1000
  schedule: cosine
  cosine_s: 0.008
  num_suffix_steps: 10  # Number of future timesteps in suffix

model:
  in_channels: 1
  base_channels: 64
  channel_mults: [1, 2, 4]
  num_res_blocks: 2
  time_emb_dim: 256
  context_dim: 256  # Dimension of suffix context embedding

encoder:
  hidden_dim: 256
  num_heads: 4
  num_layers: 2
  pooling: mean  # mean, max, or cls

training:
  epochs: 47  # ~22K steps (60K/128 = 469 steps/epoch, 47*469 â‰ˆ 22K steps)
  lr: 2.0e-4
  weight_decay: 0.0
  log_every: 100
  sample_every_steps: 1000
  save_every_steps: 2000
  out_dir: experiments/nonmarkov_ddim
  ema_decay: 0.999
  loss_type: epsilon  # 'epsilon' (predict noise) or 'dart' (predict x0)
  weighting: none  # For epsilon: 'none' (uniform); for dart: 'snr_sum', 'truncated_snr', etc.
  use_cfg: false  # Disable CFG for epsilon prediction baseline
  context_dropout: 0.0

sampling:
  cfg_scale: 0.0  # No CFG

